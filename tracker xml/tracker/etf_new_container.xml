<system>
<keyword>note</keyword>
	<indexing_tag>description</indexing_tag><symbol>:</symbol> <string>&quot;&quot;</string>
	<indexing_tag>author</indexing_tag><symbol>:</symbol> <string>&quot;&quot;</string>
	<indexing_tag>date</indexing_tag><symbol>:</symbol> <string>&quot;$Date$&quot;</string>
	<indexing_tag>revision</indexing_tag><symbol>:</symbol> <string>&quot;$Revision$&quot;</string>

<keyword>class</keyword> 
	<class><location>../tracker/etf_new_container.xml</location>ETF_NEW_CONTAINER</class>

<keyword>inherit</keyword>
	<class><include>False</include>ETF_NEW_CONTAINER_INTERFACE</class>
		<keyword>redefine</keyword>
			<feature><location>../tracker/etf_new_container.xml#f_new_container</location>new_container</feature>
		<keyword>end</keyword>

<keyword>create</keyword> 
	<feature><include>False</include>make</feature>

<keyword>feature</keyword> <comment>--</comment><comment> command</comment>

	<anchor>f_new_container</anchor><feature><location>../tracker/etf_new_container.xml#f_new_container</location>new_container</feature> <symbol>(</symbol><local>cid</local><symbol>:</symbol> <class><include>False</include>STRING_8</class><symbol>;</symbol> <local>c</local><symbol>:</symbol> <class><include>False</include>TUPLE</class> <symbol>[</symbol><local>material</local><symbol>:</symbol> <class><include>False</include>INTEGER_64</class><symbol>;</symbol> <local>radioactivity</local><symbol>:</symbol> <class><location>../mathmodels/value.xml</location>VALUE</class><symbol>]</symbol><symbol>;</symbol> <local>pid</local><symbol>:</symbol> <class><include>False</include>STRING_8</class><symbol>)</symbol>
		<keyword>require else</keyword>
				<feature><include>False</include>new_container_precond</feature><symbol> </symbol><symbol>(</symbol><local>cid</local><symbol>,</symbol> <local>c</local><symbol>,</symbol> <local>pid</local><symbol>)</symbol>
		<keyword>local</keyword>
			<local>e_command</local><symbol>:</symbol> <class><location>../tracker/error.xml</location>ERROR</class>
			<local>command</local><symbol>:</symbol> <class><location>../tracker/new_container.xml</location>NEW_CONTAINER</class>
			<local>error</local><symbol>:</symbol> <class><include>False</include>STRING_8</class>
		<keyword>do</keyword>
			<feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_set_state</location>set_state</feature><symbol> </symbol><symbol>(</symbol><feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_get_state</location>get_state</feature> <symbol>+</symbol> <number>1</number><symbol>)</symbol>
			<keyword>if</keyword> <keyword>not</keyword> <feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_valid_string</location>valid_string</feature><symbol> </symbol><symbol>(</symbol><local>cid</local><symbol>)</symbol> <keyword>then</keyword>
				<local>error</local> <symbol>:=</symbol> <symbol>(</symbol><feature><location>../tracker/etf_command.xml#f_msg</location>msg</feature><dot>.</dot><feature><location>../tracker/messages_access.xml#f_invalid_name_id</location>Invalid_name_id</feature><symbol>)</symbol>
			<keyword>elseif</keyword> <feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_cid_exists</location>cid_exists</feature><symbol> </symbol><symbol>(</symbol><local>cid</local><symbol>)</symbol> <keyword>then</keyword>
				<local>error</local> <symbol>:=</symbol> <symbol>(</symbol><feature><location>../tracker/etf_command.xml#f_msg</location>msg</feature><dot>.</dot><feature><location>../tracker/messages_access.xml#f_cont_id_in_tracker</location>Cont_id_in_tracker</feature><symbol>)</symbol>
			<keyword>elseif</keyword> <keyword>not</keyword> <feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_valid_string</location>valid_string</feature><symbol> </symbol><symbol>(</symbol><local>pid</local><symbol>)</symbol> <keyword>then</keyword>
				<local>error</local> <symbol>:=</symbol> <symbol>(</symbol><feature><location>../tracker/etf_command.xml#f_msg</location>msg</feature><dot>.</dot><feature><location>../tracker/messages_access.xml#f_invalid_name_id</location>Invalid_name_id</feature><symbol>)</symbol>
			<keyword>elseif</keyword> <keyword>not</keyword> <feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_get_phases</location>get_phases</feature><dot>.</dot><feature><include>False</include>has</feature><symbol> </symbol><symbol>(</symbol><local>pid</local><symbol>)</symbol> <keyword>then</keyword>
				<local>error</local> <symbol>:=</symbol> <symbol>(</symbol><feature><location>../tracker/etf_command.xml#f_msg</location>msg</feature><dot>.</dot><feature><location>../tracker/messages_access.xml#f_phase_id_non_existent</location>Phase_id_non_existent</feature><symbol>)</symbol>
			<keyword>elseif</keyword> <symbol>(</symbol><local>c</local><dot>.</dot><local>radioactivity</local><dot>.</dot><feature><location>../mathmodels/value.xml#f_as_double</location>as_double</feature> <symbol>&lt;</symbol> <number>0.0</number><symbol>)</symbol> <keyword>then</keyword>
				<local>error</local> <symbol>:=</symbol> <symbol>(</symbol><feature><location>../tracker/etf_command.xml#f_msg</location>msg</feature><dot>.</dot><feature><location>../tracker/messages_access.xml#f_cont_rad_non_negative</location>Cont_rad_non_negative</feature><symbol>)</symbol>
			<keyword>elseif</keyword> <keyword>not</keyword> <feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_under_capacity</location>under_capacity</feature><symbol> </symbol><symbol>(</symbol><local>pid</local><symbol>)</symbol> <keyword>then</keyword>
				<local>error</local> <symbol>:=</symbol> <symbol>(</symbol><feature><location>../tracker/etf_command.xml#f_msg</location>msg</feature><dot>.</dot><feature><location>../tracker/messages_access.xml#f_cont_exceeds_cap</location>Cont_exceeds_cap</feature><symbol>)</symbol>
			<keyword>elseif</keyword> <local>c</local><dot>.</dot><local>radioactivity</local> <symbol>&gt;</symbol> <feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_get_max_cont_rad</location>get_max_cont_rad</feature> <keyword>then</keyword>
				<local>error</local> <symbol>:=</symbol> <symbol>(</symbol><feature><location>../tracker/etf_command.xml#f_msg</location>msg</feature><dot>.</dot><feature><location>../tracker/messages_access.xml#f_cont_exceeds_rad_cap</location>Cont_exceeds_rad_cap</feature><symbol>)</symbol>
			<keyword>elseif</keyword> <feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_cont_gt_max_phase_rad</location>cont_gt_max_phase_rad</feature><symbol> </symbol><symbol>(</symbol><local>c</local><dot>.</dot><local>radioactivity</local><symbol>,</symbol> <local>pid</local><symbol>)</symbol> <keyword>then</keyword>
				<local>error</local> <symbol>:=</symbol> <symbol>(</symbol><feature><location>../tracker/etf_command.xml#f_msg</location>msg</feature><dot>.</dot><feature><location>../tracker/messages_access.xml#f_cont_exceeds_rad</location>Cont_exceeds_rad</feature><symbol>)</symbol>
			<keyword>elseif</keyword> <keyword>not</keyword> <feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_phase_expects_mat</location>phase_expects_mat</feature><symbol> </symbol><symbol>(</symbol><local>c</local><dot>.</dot><local>material</local><symbol>,</symbol> <local>pid</local><symbol>)</symbol> <keyword>then</keyword>
				<local>error</local> <symbol>:=</symbol> <symbol>(</symbol><feature><location>../tracker/etf_command.xml#f_msg</location>msg</feature><dot>.</dot><feature><location>../tracker/messages_access.xml#f_material_unexpected</location>Material_unexpected</feature><symbol>)</symbol>
			<keyword>else</keyword>
				<local>error</local> <symbol>:=</symbol> <feature><location>../tracker/etf_command.xml#f_msg</location>msg</feature><dot>.</dot><feature><location>../tracker/messages_access.xml#f_ok</location>Ok</feature>
			<keyword>end</keyword>
			<keyword>if</keyword> <local>error</local> <symbol>/~</symbol> <feature><location>../tracker/etf_command.xml#f_msg</location>msg</feature><dot>.</dot><feature><location>../tracker/messages_access.xml#f_ok</location>Ok</feature> <keyword>then</keyword>
				<keyword>create</keyword> <local>e_command</local><dot>.</dot><feature><location>../tracker/error.xml#f_make</location>make</feature><symbol> </symbol><symbol>(</symbol><local>error</local><symbol>)</symbol>
				<feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_get_history</location>get_history</feature><dot>.</dot><feature><location>../tracker/history.xml#f_add_to_record</location>add_to_record</feature><symbol> </symbol><symbol>(</symbol><local>e_command</local><symbol>)</symbol>
				<local>e_command</local><dot>.</dot><feature><location>../tracker/error.xml#f_execute</location>execute</feature>
			<keyword>else</keyword>
				<keyword>create</keyword> <local>command</local><dot>.</dot><feature><location>../tracker/new_container.xml#f_make</location>make</feature><symbol> </symbol><symbol>(</symbol><local>cid</local><symbol>,</symbol> <local>c</local><symbol>,</symbol> <local>pid</local><symbol>)</symbol>
				<feature><location>../tracker/etf_command.xml#f_model</location>model</feature><dot>.</dot><feature><location>../tracker/tracker.xml#f_get_history</location>get_history</feature><dot>.</dot><feature><location>../tracker/history.xml#f_add_to_record</location>add_to_record</feature><symbol> </symbol><symbol>(</symbol><local>command</local><symbol>)</symbol>
				<local>command</local><dot>.</dot><feature><location>../tracker/new_container.xml#f_execute</location>execute</feature>
			<keyword>end</keyword>
			<feature><include>False</include>etf_cmd_container</feature><dot>.</dot><feature><include>False</include>on_change</feature><dot>.</dot><feature><include>False</include>notify</feature><symbol> </symbol><symbol>(</symbol><symbol>[</symbol><keyword>Current</keyword><symbol>]</symbol><symbol>)</symbol>
		<keyword>end</keyword>
	
<keyword>end</keyword> <comment>--</comment> <comment>class </comment><class><location>../tracker/etf_new_container.xml</location>ETF_NEW_CONTAINER</class></system>

